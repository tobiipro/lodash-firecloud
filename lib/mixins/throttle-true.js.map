{"version":3,"sources":["../../src/mixins/throttle-true.ts"],"names":[],"mappings":"yGAAA,wD;;;;;;AAMA;;;;;;;;;;;AAWO,IAAI,YAAY,GAAG,UAAuB,MAAvB,EAAkC,QAAlC,EAAsE;AAC9F,MAAI,cAAc,GAAG,CAArB;AACA,MAAI,gBAAJ;;AAEA,MAAI,QAAQ,GAAG,gBAAE,MAAF,CAAS,UAAS,GAAG,IAAZ,EAAgD;AACtE;AACA,QAAI,QAAQ,KAAK,CAAjB,EAAoB;AAClB,aAAO,MAAM,CAAC,GAAG,IAAJ,CAAb;AACD;;AAED,QAAI,GAAG,GAAG,IAAI,CAAC,GAAL,EAAV;AACA,QAAI,GAAG,GAAG,cAAN,GAAuB,QAA3B,EAAqC;AACnC,aAAO,gBAAP;AACD;;AAED,IAAA,cAAc,GAAG,GAAjB;AACA,IAAA,gBAAgB,GAAG,MAAM,CAAC,GAAG,IAAJ,CAAzB;AACA,WAAO,gBAAP;AACD,GAdc,EAcP;AACN,IAAA,KAAK,EAAE,YAAW;AAChB,MAAA,cAAc,GAAG,CAAjB;AACD,KAHK;AAIN,IAAA,MAAM,EAAE,YAAW;AACjB,MAAA,cAAc,GAAG,CAAjB;AACD,KANK,EAdO,CAAf;;;AAuBA,SAAO,QAAP;AACD,CA5BM,C","file":"throttle-true.js","sourcesContent":["import _ from 'lodash';\n\nimport {\n  Fn\n} from '../types';\n\n/**\n * Part of `lodash-firecloud`.\n *\n * A \"true\" _.throttle with 'trailing': false\".\n * A lightweight version which does not allocate unnecessary timer,\n * comparing to the original _.throttle (which invokes _.debounce under the hood).\n *\n * @param origFn Function to throttle.\n * @param interval Throttling interval.\n * @returns The throttled function.\n */\nexport let throttleTrue = function<T extends Fn>(origFn: T, interval: number): T & _.Cancelable {\n  let lastInvokeTime = 0;\n  let lastInvokeResult;\n\n  let toInvoke = _.assign(function(...args: Parameters<T>): ReturnType<T> {\n    // special case for direct call\n    if (interval === 0) {\n      return origFn(...args) as ReturnType<T>;\n    }\n\n    let now = Date.now();\n    if (now - lastInvokeTime < interval) {\n      return lastInvokeResult;\n    }\n\n    lastInvokeTime = now;\n    lastInvokeResult = origFn(...args);\n    return lastInvokeResult;\n  } as T, {\n    flush: function() {\n      lastInvokeTime = 0;\n    },\n    cancel: function() {\n      lastInvokeTime = 0;\n    }\n  });\n\n  return toInvoke;\n};\n"]}
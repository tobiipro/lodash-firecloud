{"version":3,"sources":["../../src/mixins/safe-proxy.ts"],"names":[],"mappings":"sGAAA,wD;;AAEA;AACA;AACA;;AAEA;;;;;;;;AAQO,IAAI,SAAS,GAAG,UAAS,GAAT,EAA4D;AACjF;AACA,SAAO,IAAI,KAAJ,CAAU,GAAV,EAAe;AACpB,IAAA,GAAG,EAAE,UAAS,MAAT,EAAiB,QAAjB,EAA2B,SAA3B,EAA+C;AAClD,UAAI,gBAAE,QAAF,CAAW,QAAX,CAAJ,EAA0B;AACxB,eAAO,MAAM,CAAC,QAAD,CAAb;AACD;;AAED,UAAI,gBAAE,QAAF,CAAW;AACb,mBADa;AAEb,cAFa,CAAX;AAGD,MAAA,QAHC,CAAJ,EAGc;AACZ,eAAO,MAAM,CAAC,QAAD,CAAb;AACD;;AAED,UAAI,QAAQ,KAAK,OAAjB,EAA0B;AACxB,eAAO,YAAW;AAChB,cAAI,SAAS,GAAG,gBAAE,KAAF,CAAQ,MAAR,CAAhB;AACA,iBAAO,SAAS,CAAC,SAAD,CAAhB;AACD,SAHD;AAID;;AAED;AACA,UAAI,QAAQ,KAAK,MAAjB,EAAyB;AACvB;AACD;;AAED,UAAI,gBAAE,KAAF,CAAQ,MAAM,CAAC,QAAD,CAAd,CAAJ,EAA+B;AAC7B,cAAM,IAAI,KAAJ,CAAW,GAAE,QAAS,cAAtB,CAAN;AACD;;AAED,aAAO,MAAM,CAAC,QAAD,CAAb;AACD,KA9BmB,EAAf,CAAP;;AAgCD,CAlCM,C","file":"safe-proxy.js","sourcesContent":["import _ from 'lodash';\n\n// NOTE if you need to check if an env var exist, use\n// '<var>' in someProxy\n// e.g. if ('PATH' in _.safeProxy(process.env)) { ...do smth with _.safeProxy(process.env).PATH... }\n\n/**\n * Part of `lodash-firecloud`.\n *\n * Create Proxy to an object object that will throw if a property is not set (nil).\n *\n * @param env The object.\n * @returns Return a safe Proxy to env.\n */\nexport let safeProxy = function(env: _.Dictionary<unknown>): _.Dictionary<unknown> {\n  // eslint-disable-next-line fp/no-proxy\n  return new Proxy(env, {\n    get: function(target, property, _receiver): unknown {\n      if (_.isSymbol(property)) {\n        return target[property as any];\n      }\n\n      if (_.includes([\n        'constructor',\n        'length'\n      ], property)) {\n        return target[property];\n      }\n\n      if (property === 'clone') {\n        return function() {\n          let newTarget = _.clone(target);\n          return safeProxy(newTarget);\n        };\n      }\n\n      // support async/await syntax\n      if (property === 'then') {\n        return;\n      }\n\n      if (_.isNil(target[property])) {\n        throw new Error(`${property} is not set.`);\n      }\n\n      return target[property];\n    }\n  });\n};\n"]}